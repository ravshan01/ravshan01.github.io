class App{constructor(e){this.isPlay=!1,this.table={$tableWrap:e.table.$tableWrap?document.querySelector(e.table.$tableWrap):document.querySelector(".table-wrap"),$table:e.table.$table?document.querySelector(e.table.$table):document.querySelector(".table"),$play:document.querySelector(".play"),$stop:document.querySelector(".stop"),$time:document.querySelector(".time"),$win:document.querySelector(".win"),$winTime:document.querySelector(".win-time"),seconds:0,minutes:0,time:"",activeNum:1,maxNum:0},this.settings={$settings:e.settings.$settings?document.querySelector(e.settings.$settings):document.querySelector(".settings"),$settingsLink:e.settings.$settingsLink?document.querySelector(e.settings.$settingsLink):document.querySelector(".settings-link"),$play:document.querySelector(".start"),$stop:document.querySelector(".stop"),$info:document.querySelector(".info"),$infoLink:document.querySelector(".info-link"),$infoText:document.querySelector(".info-text"),$columns:document.querySelectorAll(".columns a"),$rows:document.querySelectorAll(".rows a"),$themes:document.querySelectorAll(".theme")},this.config={columnCount:e.config.columnCount?e.config.columnCount:5,rowCount:e.config.rowCount?e.config.rowCount:5,theme:e.config.theme?e.config.theme:"bg-blue"}}init(){this.changeTableSize(),this.changeTableClass(),this.createTableCells(),this.createEventListener(),this.changeTheme()}reInit(e){e&&e.preventDefault(),this.reset(),this.changeTableClass(),this.createTableCells()}play(e){if(e&&e.preventDefault(),1==this.isPlay)return!1;this.table.$play.classList.add("scale-0"),this.table.$stop.classList.add("scale-1"),this.isPlay=!0,this.time.bind(this)(),this.timer=setInterval(this.time.bind(this),1e3)}reset(e){this.table.$table.innerHTML="",this.table.$play.classList.remove("scale-0"),this.table.$stop.classList.remove("scale-1"),this.isPlay=!1,this.table.seconds=0,this.table.minutes=0,this.table.time="00:00",this.table.$time.innerText="00:00",this.table.activeNum=1,clearInterval(this.timer)}end(){this.table.$win.classList.add("visible"),this.table.$winTime.innerText=this.table.time,setTimeout((()=>this.table.$win.classList.remove("visible")),2500),this.reInit()}createTableCells(){let e=this.config.columnCount*this.config.rowCount,t=this.createNumbers(e);this.table.maxNum=e;for(let s=0;s<e;s++){let e=document.createElement("div");e.innerText=t[s],e.classList.add("cell"),e.addEventListener("click",this.cellClick.bind(this)),this.table.$table.append(e)}}cellClick(e){if(0==this.isPlay)return!1;let t=e.target,s=+t.innerText,i=this.checkCorrectNum(s),l=i.correct,n=i.end,a="green";0==l&&(a="red"),t.classList.add(a),setTimeout((()=>t.classList.remove(a)),1400),n&&this.end()}checkCorrectNum(e){let t={correct:!1,end:!1},s=this.table.activeNum;return e==s&&(t.correct=!0,this.table.activeNum++),e==this.table.maxNum&&e==s&&(t.end=!0),t}changeTableSize(){let e=this.table.$tableWrap,t=e.offsetWidth,s=e.offsetHeight,i="",l="";t>s&&(i=l=s-70+"px"),t<s&&(i=l=t-70+"px"),this.table.$table.style.width=i,this.table.$table.style.height=l}createEventListener(){this.settings.$columns.forEach((e=>e.addEventListener("click",this.changeColumnClick.bind(this)))),this.settings.$rows.forEach((e=>e.addEventListener("click",this.changeRowClick.bind(this)))),this.table.$play.addEventListener("click",this.play.bind(this)),this.table.$stop.addEventListener("click",this.reInit.bind(this)),this.settings.$settingsLink.addEventListener("click",this.toggleShowSettings.bind(this)),this.settings.$themes.forEach((e=>e.addEventListener("click",this.changeTheme.bind(this)))),this.settings.$infoLink.addEventListener("click",(e=>{e.preventDefault(),this.settings.$infoText.classList.toggle("visible")}))}changeColumnClick(e){e&&e.preventDefault(),document.querySelector(".column-active").classList.remove("column-active");let t=e.target;t.classList.add("column-active"),this.config.columnCount=+t.innerText,this.reInit.bind(this)()}changeRowClick(e){e&&e.preventDefault(),document.querySelector(".row-active").classList.remove("row-active");let t=e.target;t.classList.add("row-active"),this.config.rowCount=+t.innerText,this.reInit.bind(this)()}time(){let e="",t="",s="";this.table.seconds++,this.table.seconds>=60&&(this.table.seconds=0,this.table.minutes++),e=this.table.seconds>=10?this.table.seconds.toString():"0"+this.table.seconds,t=this.table.minutes>=10?this.table.minutes.toString():"0"+this.table.minutes,s=t+":"+e,this.table.time=s,this.table.$time.innerText=s}createNumbers(e){let t=e,s=[];for(let e=0;e<t;e++){let e=0,i=!1;for(;0==i;)e=Math.ceil(Math.random()*t),-1==s.indexOf(e)&&(i=!0);s.push(e)}return s}changeTableClass(){let e=this.table.$table;e.classList.value="",e.classList.add("table"),e.classList.add("grid-col-"+this.config.columnCount),e.classList.add("grid-row-"+this.config.rowCount)}toggleShowSettings(e){e&&e.preventDefault(),this.settings.$settings.classList.toggle("translate-0")}changeTheme(e){let t="",s=!1;if(e||(t=this.config.theme),e){let i=e.target;t=i.dataset.value,this.config.theme=t,s=i.querySelector("i"),s.style.visibility="visible",document.querySelector(".theme-active").classList.remove("theme-active"),i.classList.add("theme-active")}let i=new Image;i.src={"bg-blue":"./assets/images/bg-blue.png","bg-green":"./assets/images/bg-green.png","bg-pink":"./assets/images/bg-pink.png"}[t],i.onload=()=>{document.body.style.backgroundImage=`url(${i.src})`,s&&(s.style.visibility="hidden")}}}